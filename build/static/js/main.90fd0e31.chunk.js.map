{"version":3,"sources":["Login.js","Home.js","CreateSingleVote.js","CreateMultipleVote.js","VoteView.js","My.js","Signup.js","App.js","serviceWorker.js","index.js"],"names":["Login","captchaRef","useRef","history","useHistory","Form","useForm","form","layout","className","initialValues","remember","Item","name","rules","required","message","placeholder","Password","visibilityToggle","src","Date","now","alt","ref","onClick","current","type","htmlType","e","preventDefault","axios","post","getFieldsValue","then","res","success","push","error","warning","response","data","msg","toString","code","resetFields","to","Home","style","width","size","get","CreateSingleVote","useState","options","setOptions","deadline","setDeadLine","anonymous","setAnonymous","a","voteInfo","title","getFieldValue","description","ddl","_d","toISOString","multiple","voteId","map","it","idx","key","value","onChange","slice","target","length","filter","_","index","deleteSelection","showTime","onOk","format","defaultValue","moment","checked","CreateMultipleVote","VoteView","userInfo","loading","setLoading","setVoteInfo","votings","setVotings","id","useParams","useEffect","getTime","ws","WebSocket","onmessage","JSON","parse","close","groupedVotings","groupBy","userCount","Set","userId","option","currentVoting","hasCurrUserVoted","Boolean","find","optionId","hasVoted","thisVote","avatar","remove","cancel","voteUp","content","calcRatio","vote","toLocaleString","num","base","toFixed","My","myVotes","setMyVotes","setUserInfo","imgUrl","setImgUrl","uploadButton","LoadingOutlined","PlusOutlined","marginTop","listType","showUploadList","action","beforeUpload","file","isJpgOrPng","isLt2M","info","status","img","callback","reader","FileReader","addEventListener","result","readAsDataURL","getBase64","originFileObj","imageUrl","header","itemLayout","dataSource","renderItem","item","Meta","formItemLayout","labelCol","xs","span","sm","wrapperCol","tailFormItemLayout","offset","Signup","scrollToFirstError","label","whitespace","validator","available","dependencies","Promise","reject","resolve","App","undefined","catch","console","log","path","exact","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.90fd0e31.chunk.js","sourcesContent":["import React, { useRef } from 'react'\r\nimport axios from 'axios'\r\nimport {useHistory,Link} from 'react-router-dom'\r\nimport {Form,Input,Button,message} from 'antd'\r\nimport 'antd/dist/antd.css';\r\nimport './Login.css'\r\n\r\nexport default function Login(){\r\n  let captchaRef = useRef()\r\n  let history = useHistory()\r\n  const [form] = Form.useForm()\r\n\r\n  function handleLogin(e){\r\n    e.preventDefault()\r\n    // debugger\r\n    // console.log(form.getFieldsValue(['name','password','captcha']))\r\n    axios.post('/vote/login',form.getFieldsValue(['name','password','captcha']))\r\n    .then(function(res){\r\n      message.success('登录成功')\r\n      history.push('/')\r\n    },function(error){\r\n      message.warning(error.response.data.msg.toString())\r\n      // console.log(error.response.data)\r\n      if(error.response.data.code === 2){ //验证码错误\r\n        // console.log(captchaRef.current)\r\n        captchaRef.current.src=`/vote/captcha?t=${Date.now()}`\r\n        form.resetFields(['captcha'])\r\n      } else if(error.response.data.code === 0){  //用户名或密码错误\r\n        form.resetFields(['name','password','captcha'])\r\n        captchaRef.current.src=`/vote/captcha?t=${Date.now()}`\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  function handleCaptchaReload (){\r\n    captchaRef.current.src=`/vote/captcha?t=${Date.now()}`\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Form layout='horizontal' className=\"login-form\" initialValues={{remember:true}} form={form}>\r\n        <Form.Item name='name' rules={[{required:true,message:'请输入用户名'}]}>\r\n          <Input placeholder=\"用户名\"></Input>\r\n        </Form.Item>\r\n        <Form.Item name=\"password\" rules={[{required:true,message:'请输入密码'}]}>\r\n          <Input.Password visibilityToggle={false} placeholder=\"密码\"></Input.Password>\r\n        </Form.Item>\r\n        <Form.Item name=\"captcha\" rules={[{required:true,message:'请输入验证码'}]} className='captchaInput'>\r\n          <Input placeholder=\"验证码(区分大小写)\"></Input>\r\n        </Form.Item>\r\n        <img className='captcha' src={`/vote/captcha?t=${Date.now()}`} alt=\"captcha\" ref={captchaRef} onClick={handleCaptchaReload}></img>\r\n        {/* <Form.Item name=\"remember\" noStyle valuePropName=\"checked\">\r\n          <Checkbox className=\"remember\">记住我</Checkbox>\r\n        </Form.Item> */}\r\n        <Form.Item>\r\n          <Button type=\"primary\" htmlType=\"submit\" onClick={handleLogin} className=\"login-form-button\" >登录</Button>\r\n          <Link to='/signup'>没有账号？注册一个吧</Link>\r\n        </Form.Item>\r\n      </Form>\r\n    </>\r\n  )\r\n}","import React from 'react'\r\nimport {useHistory} from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport {Card,Button} from 'antd'\r\nimport './Home.css'\r\n\r\nexport default function Home(){\r\n  let history = useHistory()\r\n  function logout (){\r\n    axios.get('/vote/logout').then(()=>{\r\n      history.push(\"/login\")\r\n    })\r\n  }\r\n  function initSingleVote(){\r\n    history.push('/create-single-vote')\r\n  }\r\n  function initMultiVote(){\r\n    history.push('/create-multiple-vote')\r\n  }\r\n  function my () {\r\n    history.push('/my')\r\n  }\r\n  return (\r\n    <>\r\n      <Card style={{width:300}} className='card'>\r\n        <Button onClick={initSingleVote} className='button' size='large'>新建单选</Button>\r\n        <Button onClick={initMultiVote} className='button' size='large'>新建多选</Button>\r\n        <Button onClick={my} className='button' size='large'>我的</Button>\r\n        <Button onClick={logout} className='button' size='large'>登出</Button>\r\n      </Card>\r\n    </>\r\n  )\r\n}","import React,{ useState } from 'react'\r\nimport axios from 'axios'\r\nimport {useHistory} from 'react-router-dom'\r\nimport {Form,Button,Input,DatePicker,Checkbox,message} from 'antd'\r\nimport './CreateVote.css'\r\nimport moment from 'moment'\r\n\r\nexport default function CreateSingleVote(){\r\n  let [options,setOptions] = useState(['',''])\r\n  let [deadline,setDeadLine] = useState({})\r\n  let [anonymous,setAnonymous] = useState(false)\r\n  let history = useHistory()\r\n  const [form] = Form.useForm()\r\n\r\n  function deleteSelection(idx){\r\n    if(options.length === 2) {\r\n      return \r\n    }\r\n    setOptions(options.filter((_,index)=>index!==idx))\r\n  }\r\n\r\n  async function createVote () {\r\n    const voteInfo = {\r\n      title:form.getFieldValue('title'),\r\n      description:form.getFieldValue('description'),\r\n      options,\r\n      ddl:deadline._d.toISOString() ,\r\n      anonymous:anonymous ? 1 : 0,\r\n      multiple:0\r\n    }\r\n    // console.log(voteInfo)\r\n    try{\r\n      let res = await axios.post('/vote/createvote',voteInfo)\r\n      message.success('创建成功')\r\n      history.push(`/vote/${res.data.voteId}`)\r\n    } catch(e){\r\n      message.warning(e.response.data.msg.toString())\r\n    }\r\n  }\r\n\r\n  function handleTimeOk (value) {\r\n    // console.log('onOk',value)\r\n    setDeadLine(value)\r\n  }\r\n  function handleAnonymous (e) {\r\n    setAnonymous(e.target.checked)\r\n  }\r\n\r\n  return (\r\n    <div className='wrapper'>\r\n      <h3>创建单选投票</h3>\r\n      <Form form={form} layout='horizontal' >\r\n          <Form.Item name='title' rules={[{required:true,message:'投票标题必填'}]}>\r\n            <Input placeholder=\"投票标题\"></Input>\r\n          </Form.Item>\r\n          <Form.Item name='description'>\r\n            <Input placeholder='补充描述(选填)'></Input>\r\n          </Form.Item>\r\n          <div className='optionsWrapper'>\r\n            {\r\n              options.map((it,idx)=>{\r\n                return (\r\n                  <Form.Item key={idx}>\r\n                    <Input className='optionsInput' value={it} placeholder=\"选项\" onChange={(e)=>setOptions([...options.slice(0,idx),e.target.value,...options.slice(idx+1)])}></Input>\r\n                    <Button onClick={()=>deleteSelection(idx)}>&times;</Button>\r\n                  </Form.Item>\r\n                )\r\n              })\r\n            }\r\n            <Button onClick={()=>{setOptions([...options,''])}} className=\"addOption\">添加选项</Button>\r\n          </div>\r\n          <Form.Item>\r\n            <DatePicker \r\n              showTime={true} \r\n              onOk={handleTimeOk}\r\n              format='YYYY/MM/DD HH:mm' \r\n              placeholder='截止时间' \r\n              defaultValue={moment()}>\r\n            </DatePicker>\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Checkbox onChange={handleAnonymous}>匿名投票</Checkbox>\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Button onClick={createVote} type='primary'>创建</Button>\r\n          </Form.Item>\r\n      </Form>\r\n    </div>\r\n  )\r\n}\r\n\r\n","import React,{ useState } from 'react'\r\nimport axios from 'axios'\r\nimport {useHistory} from 'react-router-dom'\r\nimport {Form,Button,Input,DatePicker,Checkbox,message} from 'antd'\r\nimport './CreateVote.css'\r\nimport moment from 'moment'\r\n\r\nexport default function CreateMultipleVote(){\r\n  let [options,setOptions] = useState(['',''])\r\n  let [deadline,setDeadLine] = useState({})\r\n  let [anonymous,setAnonymous] = useState(false)\r\n  let history = useHistory()\r\n  const [form] = Form.useForm()\r\n\r\n  function deleteSelection(idx){\r\n    if(options.length === 2) {\r\n      return \r\n    }\r\n    setOptions(options.filter((_,index)=>index!==idx))\r\n  }\r\n\r\n  async function createVote () {\r\n    const voteInfo = {\r\n      title:form.getFieldValue('title'),\r\n      description:form.getFieldValue('description'),\r\n      options,\r\n      ddl:deadline._d.toISOString() ,\r\n      anonymous:anonymous ? 1 : 0,\r\n      multiple:1\r\n    }\r\n    // console.log(voteInfo)\r\n    try{\r\n      let res = await axios.post('/vote/createvote',voteInfo)\r\n      message.success('创建成功')\r\n      history.push(`/vote/${res.data.voteId}`)\r\n    } catch(e){\r\n      message.warning(e.response.data.msg.toString())\r\n    }\r\n  }\r\n\r\n  function handleTimeOk (value) {\r\n    // console.log('onOk',value)\r\n    setDeadLine(value)\r\n  }\r\n  function handleAnonymous (e) {\r\n    setAnonymous(e.target.checked)\r\n  }\r\n\r\n  return (\r\n    <div className='wrapper'>\r\n      <h3>创建多选投票</h3>\r\n      <Form form={form} layout='horizontal' >\r\n          <Form.Item name='title' rules={[{required:true,message:'投票标题必填'}]}>\r\n            <Input placeholder=\"投票标题\"></Input>\r\n          </Form.Item>\r\n          <Form.Item name='description'>\r\n            <Input placeholder='补充描述(选填)'></Input>\r\n          </Form.Item>\r\n          <div className='optionsWrapper'>\r\n            {\r\n              options.map((it,idx)=>{\r\n                return (\r\n                  <Form.Item key={idx}>\r\n                    <Input className='optionsInput' value={it} placeholder=\"选项\" onChange={(e)=>setOptions([...options.slice(0,idx),e.target.value,...options.slice(idx+1)])}></Input>\r\n                    <Button onClick={()=>deleteSelection(idx)}>&times;</Button>\r\n                  </Form.Item>\r\n                )\r\n              })\r\n            }\r\n            <Button onClick={()=>{setOptions([...options,''])}} className=\"addOption\">添加选项</Button>\r\n          </div>\r\n          <Form.Item>\r\n            <DatePicker \r\n              showTime={true} \r\n              onOk={handleTimeOk}\r\n              format='YYYY/MM/DD HH:mm' \r\n              placeholder='截止时间' \r\n              defaultValue={moment()}>\r\n            </DatePicker>\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Checkbox onChange={handleAnonymous}>匿名投票</Checkbox>\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Button onClick={createVote} type='primary'>创建</Button>\r\n          </Form.Item>\r\n      </Form>\r\n    </div>\r\n  )\r\n}","import React, { useEffect, useState } from 'react'\r\nimport {useParams} from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport './VoteView.css'\r\nimport {groupBy,remove} from 'lodash'\r\nimport {Checkbox,message} from 'antd'\r\n\r\nexport default function VoteView ({userInfo={}}){\r\n  let [loading,setLoading] = useState(true)\r\n  let [voteInfo,setVoteInfo] = useState(null)\r\n  let [votings, setVotings] = useState(null)\r\n  let {id} = useParams() //投票id\r\n\r\n  useEffect(()=>{\r\n    setLoading(true)\r\n    setVoteInfo(null)\r\n    axios.get(`/vote/vote/${id}`).then((res)=>{\r\n      setVoteInfo(res.data)\r\n      setVotings(res.data.votings)\r\n      setLoading(false)\r\n      // console.log(res.data)\r\n    })\r\n  },[id])\r\n\r\n  useEffect(()=>{\r\n    //用于接收某个vote的新的选票信息\r\n    if(!voteInfo){\r\n      return\r\n    }\r\n    if(Date.now() < new Date(voteInfo.ddl).getTime()){\r\n      let ws = new WebSocket(`wss://johann.one:8080/vote/${id}`)\r\n      ws.onmessage = e =>{\r\n        let votings = JSON.parse(e.data)\r\n        setVotings(votings)\r\n      }\r\n  \r\n      return ()=>ws.close()\r\n    }\r\n  },[id,voteInfo])\r\n\r\n  function voteUp(optionId,hasVoted){\r\n    //已过截至时间\r\n    if(Date.now() > new Date(voteInfo.ddl).getTime()){\r\n      message.warning('截止时间已过，不能投票啦')\r\n      return \r\n    }\r\n    //自己投的一票立即设置到votings上，避免延迟\r\n    let thisVote = {\r\n      optionId,\r\n      voteId:id,\r\n      userId:userInfo.id,\r\n      avatar:userInfo.avatar\r\n    }\r\n    if(voteInfo.multiple){\r\n      //多选\r\n      if(hasVoted){\r\n        //取消投票\r\n        remove(votings,(it)=>{\r\n          return it.userId === userInfo.id && it.optionId === optionId\r\n        })\r\n        setVotings(votings)\r\n      } else {\r\n        //投票\r\n        setVotings([...votings,thisVote])\r\n      }\r\n    } else {\r\n      if(hasVoted){\r\n        //取消投票\r\n        remove(votings,(it)=>{\r\n          return it.userId === userInfo.id\r\n        })\r\n        setVotings(votings)\r\n      } else {\r\n        //投票\r\n        remove(votings,(it)=>{\r\n          return it.userId === userInfo.id\r\n        })\r\n        setVotings([...votings,thisVote])\r\n      }\r\n    }\r\n\r\n\r\n    axios.post(`/vote/vote/${id}`,{\r\n      optionId,\r\n      cancel:hasVoted\r\n    })\r\n  }\r\n\r\n  if(loading){\r\n    return <div>loading...</div>\r\n  } else {\r\n    let groupedVotings = groupBy(votings,'optionId')\r\n    // console.log('rendering',groupedVotings)\r\n    let userCount = new Set(votings.map(it=> it.userId)).size\r\n    return (\r\n      <div className=\"wrapper\">\r\n        <h2>{voteInfo.title} {voteInfo.multiple ? '【多选】' : '【单选】'}</h2>\r\n        <p>  {voteInfo.description}</p>\r\n        <ul className=\"votes\">\r\n          {voteInfo.options.map((option)=>{\r\n            let currentVoting = groupedVotings[option.id] || [] //当前选项的所有投票\r\n            let hasCurrUserVoted = Boolean(currentVoting.find(it=>it.userId === userInfo.id))\r\n            return (\r\n            <li key={option.id} onClick={()=>voteUp(option.id,hasCurrUserVoted)}> {/*选项id*/}\r\n              <Checkbox checked={hasCurrUserVoted}></Checkbox>\r\n              {' '}\r\n              <span className='option-text'>{option.content}</span>\r\n              {' '}\r\n              <strong>{currentVoting.length}票 {calcRatio(currentVoting.length,userCount)}%</strong>\r\n              <div className='option-ratio' style={{width:calcRatio(currentVoting.length,userCount) + '%'}}></div>\r\n              <ul className='avatars'>\r\n                {\r\n                  currentVoting.map(vote=>{return (\r\n                    <li key={vote.userId}><img src={vote.avatar} className='avatar' alt=\"avatar\"></img></li>\r\n                  )})\r\n                }\r\n              </ul>\r\n            </li>)\r\n          })}\r\n        </ul>\r\n        <p>投票截至：{new Date(voteInfo.ddl).toLocaleString() }</p>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nfunction calcRatio (num,base){\r\n  if(base === 0) {\r\n    return 0\r\n  }\r\n  return (num / base * 100).toFixed(2)\r\n}","import React, { useEffect, useState } from 'react'\r\nimport axios from 'axios'\r\nimport {Link} from 'react-router-dom'\r\nimport {List,Card,Avatar,Upload,message, Button} from 'antd'\r\nimport './My.css'\r\nimport { LoadingOutlined, PlusOutlined } from '@ant-design/icons';\r\n\r\n\r\nexport default function My (){\r\n  let [myVotes,setMyVotes] = useState([])\r\n  let [userInfo, setUserInfo] = useState({})\r\n  let [loading,setLoading] = useState(false)\r\n  let [imgUrl,setImgUrl] = useState('')\r\n\r\n  useEffect(()=>{\r\n    axios.get('/vote/myvote').then(res=>{\r\n      setMyVotes(res.data)\r\n      // console.log(res.data)\r\n    })\r\n  },[])\r\n  \r\n  useEffect(()=>{\r\n    axios.get('/vote/userinfo').then(res=>{\r\n      setUserInfo(res.data)\r\n      // console.log('userinfo',res.data)\r\n    })\r\n  },[imgUrl])\r\n\r\n  function beforeUpload(file) {\r\n    const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png'\r\n    if (!isJpgOrPng) {\r\n      message.error('只能上传JPG或PNG文件')\r\n    }\r\n    const isLt2M = file.size / 1024 / 1024 < 2;\r\n    if (!isLt2M) {\r\n      message.error('头像应小于2MB!')\r\n    }\r\n    return isJpgOrPng && isLt2M\r\n  }\r\n\r\n  function handleChange(info) {\r\n    if (info.file.status === 'uploading') {\r\n      setLoading(true)\r\n      return\r\n    }\r\n    if (info.file.status === 'done') {\r\n      // Get this url from response in real world.\r\n      getBase64(info.file.originFileObj, imageUrl => {\r\n        setImgUrl(imageUrl)\r\n        setLoading(false)\r\n      })\r\n    }\r\n  }\r\n  function getBase64(img, callback) {\r\n    const reader = new FileReader();\r\n    reader.addEventListener('load', () => callback(reader.result));\r\n    reader.readAsDataURL(img);\r\n  }\r\n\r\n  const uploadButton = (\r\n    <div className='uploadButton'>\r\n      {loading ? <LoadingOutlined /> : <PlusOutlined />}\r\n      <span style={{ marginTop: 8 }}>上传头像</span>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"wrapper\">\r\n      <Card className='user'>\r\n        <h2 className='userName'>{userInfo.name}</h2>\r\n        <Avatar size='large' src={userInfo.avatar}></Avatar>\r\n        <Upload\r\n        name=\"avatar\"\r\n        listType=\"picture-card\"\r\n        className=\"avatar-uploader\"\r\n        showUploadList={false}\r\n        action=\"/vote/uploads\"\r\n        beforeUpload={beforeUpload}\r\n        onChange={handleChange}>\r\n          {uploadButton}\r\n          {/* <Button icon={loading ? <LoadingOutlined /> : <PlusOutlined />}>上传头像</Button> */}\r\n        </Upload>\r\n      </Card>\r\n      <Card className=\"myVotes\">\r\n        <List \r\n          header={<h3>我创建的投票：</h3>}\r\n          itemLayout=\"horizontal\" \r\n          dataSource={myVotes}\r\n          renderItem={item=>(\r\n            <List.Item>\r\n              <List.Item.Meta\r\n                title={<Link to={`/vote/${item.id}`}>{item.title}</Link>}\r\n              ></List.Item.Meta>\r\n            </List.Item>\r\n          )}\r\n        ></List>\r\n      </Card>\r\n    </div>\r\n  )\r\n}","import React from 'react'\r\nimport {useHistory} from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport {Form,Input,Button,message} from 'antd'\r\nimport 'antd/dist/antd.css';\r\nimport './Signup.css'\r\n\r\nconst formItemLayout = {\r\n  labelCol: {\r\n    xs: {\r\n      span: 24,\r\n    },\r\n    sm: {\r\n      span: 8,\r\n    },\r\n  },\r\n  wrapperCol: {\r\n    xs: {\r\n      span: 24,\r\n    },\r\n    sm: {\r\n      span: 16,\r\n    },\r\n  },\r\n}\r\n\r\nconst tailFormItemLayout = {\r\n  wrapperCol: {\r\n    xs: {\r\n      span: 24,\r\n      offset: 0,\r\n    },\r\n    sm: {\r\n      span: 16,\r\n      offset: 8,\r\n    },\r\n  },\r\n};\r\n\r\n\r\nexport default function Signup (){\r\n  const [form] = Form.useForm()\r\n  const history = useHistory()\r\n\r\n  function handleRegister(e){\r\n    e.preventDefault()\r\n    // console.log(form.getFieldsValue(['username','password','email']))\r\n    axios.post('/vote/signup',form.getFieldsValue(['username','password','email']))\r\n    .then((res)=>{\r\n      // console.log(res)\r\n      message.success(res.data.msg)\r\n      history.push('/')\r\n    },(error)=>{\r\n      message.warning(error.response.data.msg.toString())\r\n      form.resetFields(['username','password','email'])\r\n    })\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Form form={form} layout='horizontal' className=\"register-form\" scrollToFirstError {...formItemLayout}>\r\n        <Form.Item \r\n        name=\"username\" label=\"用户名\" \r\n        rules={[{required:true,message:'请输入用户名',whitespace:true},\r\n          () => ({\r\n            validator(_,value){\r\n              if(value) {\r\n                return axios.get(`/vote/username-conflict?username=${value}`)\r\n                .then(res=>{\r\n                  // console.log(res.data)\r\n                  if(res.data.available){\r\n                    return (res.data.msg)\r\n                  }\r\n                  throw(res.data.msg)\r\n                })\r\n              }\r\n            }\r\n          })\r\n        ]}>\r\n          <Input></Input>\r\n        </Form.Item>\r\n\r\n        <Form.Item \r\n        name=\"password\" label=\"密码\" \r\n        rules={[{required:true,message:'请输入密码',whitespace:true}]}>\r\n          <Input.Password visibilityToggle={false}></Input.Password>\r\n        </Form.Item>\r\n\r\n        <Form.Item\r\n        name=\"confirm\" label=\"确认密码\"  dependencies={['password']}\r\n        rules={[{required:true,message:'请确认密码',whitespace:true},\r\n          ({getFieldValue}) => ({\r\n            validator(_,value){\r\n              if(!value || getFieldValue('password') === value) {\r\n                return Promise.resolve()\r\n              }\r\n              return Promise.reject('两次输入不一致')\r\n            }\r\n          })\r\n        ]}>\r\n          <Input.Password visibilityToggle={false}></Input.Password>\r\n        </Form.Item>\r\n        \r\n        <Form.Item \r\n        name=\"email\" label=\"电子邮箱\" \r\n        rules={[{type:'email',message:\"请输入正确的电子邮箱格式\"},{required:true,message:'请输入电子邮箱'},\r\n          () => ({\r\n            validator(_,value){\r\n              if(value) {\r\n                return axios.get(`/vote/email-conflict?email=${value}`)\r\n                .then(res=>{\r\n                  // console.log(res.data)\r\n                  if(res.data.available){\r\n                    return (res.data.msg)\r\n                  }\r\n                  throw(res.data.msg)\r\n                })\r\n              }\r\n            }\r\n          })\r\n        ]}>\r\n          <Input></Input>\r\n        </Form.Item>\r\n\r\n        <Form.Item {...tailFormItemLayout}>\r\n          <Button type=\"primary\" htmlType=\"submit\" className='button' onClick={handleRegister}>\r\n            注册\r\n          </Button>\r\n        </Form.Item>\r\n      </Form>\r\n    </>\r\n  )\r\n}","import React, { useEffect, useState } from 'react';\nimport {HashRouter,Route,Switch,useHistory} from 'react-router-dom'\nimport axios from 'axios'\nimport Login from './Login'\nimport Home from './Home'\nimport CreateSingleVote from './CreateSingleVote'\nimport CreateMultipleVote from \"./CreateMultipleVote\"\nimport VoteView from './VoteView'\nimport My from './My'\nimport Signup from './Signup'\n\nfunction App() {\n  let history = useHistory()\n  let [userInfo,setUserInfo] = useState(undefined)\n  useEffect(()=>{\n    axios.get('/vote/userinfo').then(res=>{  //也可以不用发请求，把用户名/用户id存在cookie里，在客户端请求页面时，服务器把它从cookie里读出来，发回来\n      setUserInfo(res.data)\n    }).catch(e=>{\n      console.log('用户未登录，将显示登录界面')\n      history.push('/login')\n    })\n  },[])\n  return (\n      <div className=\"App\">\n        <HashRouter>\n          <Switch>\n            <Route path=\"/login\">\n              <Login></Login>\n            </Route>\n            <Route path=\"/\" exact>\n              <Home></Home>\n            </Route>\n            <Route path=\"/create-single-vote\">\n              <CreateSingleVote></CreateSingleVote>\n            </Route>\n            <Route path=\"/create-multiple-vote\">\n              <CreateMultipleVote></CreateMultipleVote>\n            </Route>\n            <Route path=\"/vote/:id\">\n              <VoteView userInfo={userInfo}></VoteView>\n            </Route>\n            <Route path='/my'>\n              <My></My>\n            </Route>\n            <Route path='/signup'>\n              <Signup></Signup>\n            </Route>\n          </Switch>\n        </HashRouter>\n      </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {HashRouter} from 'react-router-dom'\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <App />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}